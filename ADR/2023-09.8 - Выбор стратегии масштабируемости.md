
**Дата:** 10 ноября 2024 г.

**Статус:** Принято

**Контекст**

Маркетплейс должен справляться с увеличением числа пользователей и нагрузки. Основные функции, такие как добавление в корзину и оформление заказов, должны работать стабильно даже при пиковой нагрузке.

**Рассмотренные варианты**

1. **Вертикальное масштабирование:**: Добавление ресурсов в отдельные серверы.
2. **Горизонтальное масштабирование:** Разделение нагрузки между серверами.

**Решение**
Выбрано горизонтальное масштабирование с кешированием и балансировкой нагрузки.
+ Горизонтальный шардинг:
**а.** Шардирование по хешированию
Шардирование пользователей, заказов и товаров по хешированию их ID.
**b.** Шардирование по географическому положению 
Распределим данные о пользователях и заказах из разных регионов (например, Москва — один шард, Петербург — другой).

**Обоснование**

- **Эффективность при пиковых нагрузках:** Балансировка позволяет распределять нагрузку.
- **Гибкость и масштабируемость:** Легче добавить новые серверы при росте нагрузки.
- **Кеширование:** Ускоряет отклик на повторяющиеся запросы.

- **Шардирование по хешированию:** Эффективное распределение нагрузки.Снижение вероятности "hot spot".
- **Географический шардинг:** Улучшает производительность, подходит для многоуровневых приложений.

**Недостатки решения**

- **Сложность управления  балансировкой:** Потребуется настройка балансировщиков и кэша.

- **Шардирование по хешированию:** Могут храниться разные типы данных в одном шарде, что повлияет на производительность.
- **Географический шардинг:** Сложности с запросами по нескольким региона,Требуется дополнительная логика маршрутизации.

**Последствия**
- **Дополнительные затраты на инфраструктуру:** Потребуются дополнительные серверы, балансировщики нагрузки и системы для управления кешированием, что увеличит эксплуатационные расходы.
- **Сложность в поддержке и администрировании:** Горизонтальное масштабирование требует управления большим количеством серверов и комплексных настроек балансировки, что потребует дополнительных ресурсов и времени для поддержки.
- **Зависимость от сетевых соединений:** Производительность системы будет зависеть от надежности и скорости сетевых соединений между серверами, что требует высокого качества инфраструктуры и регулярного мониторинга.
